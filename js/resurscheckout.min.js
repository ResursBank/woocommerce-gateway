window._resursCheckout=(function(){var b={debug:false,container:"resurs-checkout-container",domain:null,interceptor:true,on:{loaded:null,booked:null,fail:null,change:null}};var i;var c;var e;var h=null;var j={loaded:[],booked:[],fail:[],change:[]};var l={};document.addEventListener("DOMContentLoaded",function(t){h={"checkout:loaded":f,"checkout:user-info-change":s,"checkout:payment-method-change":p,"checkout:puchase-button-clicked":q,"checkout:purchase-failed":m};d()});var o=function(t){g(b,t);for(var u in b.on){if(typeof b.on[u]==="function"&&j.hasOwnProperty(u)){j[u].push(b.on[u])}}};var k=function(t,u){if(!j.hasOwnProperty(t)){console.error(t+" is not supported.");return}j[t].push(u)};var g=function(u,t){for(var v in t){if(t[v]===Object(t[v])&&typeof t[v]!=="function"){g(u[v],t[v])}else{u[v]=t[v]}}};var d=function(){i=document.getElementById(b.container);if(!i){return}c=i.getElementsByTagName("iframe")[0];if(!c){return}e=c.contentWindow||c.contentDocument;if(typeof RESURSCHECKOUT_IFRAME_URL!=="undefined"){b.domain=RESURSCHECKOUT_IFRAME_URL}if(!b.domain){console.error("You need to set a domain for the iframe communication to work.")}window.addEventListener("message",n)};var a=function(t){if(typeof e.postMessage!=="function"){console.error("The iframe element is not supporting postMessage.")}if(c.src.indexOf(b.domain)===-1){console.error("The domain set for ResursCheckoutJS must be the same as that of the iframe.")}e.postMessage(JSON.stringify(t),b.domain)};var n=function(u){if(u.origin!==b.domain||typeof u.data!=="string"){return}try{var t=JSON.parse(u.data)}catch(v){return}if(t.hasOwnProperty("eventType")&&h[t.eventType]){h[t.eventType](t)}};var f=function(t){if(b.interceptor){a({eventType:"checkout:set-purchase-button-interceptor",checkOrderBeforeBooking:true})}r("loaded",{})};var s=function(t){l={address:t.address||{},delivery:t.delivery||{},ssn:t.ssn||"",paymentMethod:t.paymentMethod||""};r("change",l)};var p=function(t){l.paymentMethod=t.method||"";r("change",l)};var q=function(t){r("booked",{rcoData:l,confirm:function(u){a({eventType:"checkout:order-status",orderReady:u})}})};var m=function(t){r("fail",{})};var r=function(u,v){for(var t=0;t<j[u].length;t++){j[u][t](v)}};return{init:o,on:k,data:l}})();