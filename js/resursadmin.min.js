var resursBankCurrentEnvironment="";$resurs_bank(document).ready(function(a){resursBankAdminRun()});function resursBankAdminRun(){resursBankCheckCredentials()}function getResursBankInputField(a){return $resurs_bank("<input>",{name:a,size:"24","class":"resursCredentialsDataField"})}function getResursBankTakenCountry(a){var b=false;$resurs_bank("select").each(function(c,d){if(d.name.indexOf("[country]")){if(d.value===a){b=true}}});return b}function getResursBankSelectField(c,b){var a=$resurs_bank("<select>",{name:c});$resurs_bank.each(b,function(d,e){if((c.indexOf("[country]")>-1&&!getResursBankTakenCountry(d))||c.indexOf("[country]")===-1){a.append(new Option(e,d,false,false))}});return a}function getResursBankSpinner(a){return $resurs_bank("<img>",{id:a+"_spin",src:resurs_bank_payment_gateway.graphics["spinner"]})}function getResursBankCheckboxField(a){return $resurs_bank("<input>",{name:a,type:"checkbox"})}function getResursBankDeleteImage(a){return $resurs_bank("<img>",{style:"cursor:pointer",src:resurs_bank_payment_gateway.graphics["delete"]}).on("click",function(){$resurs_bank("#resursbank_credential_row_"+a).remove()})}function resursBankCredentialField(){var b=0;$resurs_bank.each(["SE","DK","NO","FI"],function(e,d){if(!getResursBankTakenCountry(d)){b++}});if(b>0){var a=parseInt(Math.random()*1000);var c=$resurs_bank("<tr>",{id:"resursbank_credential_row_"+a});c.append($resurs_bank("<td>").html(getResursBankCheckboxField("resursbank_credentials["+a+"][test][active]")).prepend("<b>Active</b><br>"));c.append($resurs_bank("<td>").html(getResursBankInputField("resursbank_credentials["+a+"][test][username]")).prepend("<b>Username (Test)</b><br>"));c.append($resurs_bank("<td>").html(getResursBankInputField("resursbank_credentials["+a+"][test][password]")).prepend("<b>Password (test)</b><br>"));c.append($resurs_bank("<td>").html(getResursBankInputField("resursbank_credentials["+a+"][live][username]")).prepend("<b>Username (Live)</b><br>"));c.append($resurs_bank("<td>").html(getResursBankInputField("resursbank_credentials["+a+"][live][password]")).prepend("<b>Password (Live)</b><br>"));c.append($resurs_bank("<td>").html(getResursBankSelectField("resursbank_credentials["+a+"][country]",{SE:"Sverige",DK:"Danmark",NO:"Norge",FI:"Finland"})).prepend("<b>Country</b><br>"));c.append($resurs_bank("<td>").html(getResursBankSelectField("resursbank_credentials["+a+"][shopflow]",{checkout:"Resurs Checkout",simplified:"Simplified ShopFlow",hosted:"Hosted ShopFlow"})).prepend("<b>Chosen shopflow</b><br>"));c.append($resurs_bank("<td>").html(getResursBankDeleteImage(a)));$resurs_bank("#resurs_bank_credential_table").append(c)}else{alert("No more countries avaialble")}}function getResursBankCurrentEnvironment(){resursBankCurrentEnvironment=$resurs_bank("#resursbank_environment").val();return resursBankCurrentEnvironment}function getResursBankCountryArray(b,a,c){resurs_bank_ajaxify(b,{environment:getResursBankCurrentEnvironment},function(d){if(d.code>=205&&d.faultstring!==""){$resurs_bank.each(["SE","DK","NO","FI"],function(f,e){$resurs_bank(a+e).html(d.faultstring)})}else{c(d)}})}function resursBankHideAndShowElements(a,b){$resurs_bank(a).show();$resurs_bank(b).hide()}function resursBankDisplayCredentials(){var b=getResursBankCurrentEnvironment();var a="test";if(b==="test"){a="live"}$resurs_bank.each(["SE","DK","NO","FI"],function(d,c){resursBankHideAndShowElements("#credentials_"+b+"_username_"+c,"#credentials_"+a+"_username_"+c);resursBankHideAndShowElements("#credentials_"+b+"_password_"+c,"#credentials_"+a+"_password_"+c)})}function resursBankCredentialsUpdate(){resursBankDisplayCredentials();resursBankCheckCredentials()}function resursBankGetMethodContent(b,a){return $resurs_bank("<td>",{style:"padding: 0px;"}).html(b[a])}function resursBankGetMethodData(b){var a=$resurs_bank("<tr>");$resurs_bank.each(["id","title","description"],function(d,c){a.append(resursBankGetMethodContent(b,c))});return a}function resursBankCheckCredentials(){var b=$resurs_bank("#resurs_bank_credential_table");var a=getResursBankCurrentEnvironment();if(b.length>0){resursBankDisplayCredentials();$resurs_bank.each(["SE","DK","NO","FI"],function(d,c){$resurs_bank("#method_list_"+c).html(getResursBankSpinner("method_list_"+c))});getResursBankCountryArray("get_payment_methods","#method_list_",function(g){if(typeof g.responseAdmin==="object"){for(var d in g.responseAdmin){if(typeof g.responseAdmin[d][a]==="object"){var e=$resurs_bank("<table>",{style:"padding: 0px; border: 1px dashed gray",width:"100%"});var f=g.responseAdmin[d][a];for(var c=0;c<f.length;c++){e.append(resursBankGetMethodData(f[c]))}$resurs_bank("#method_list_"+d).html(e)}}}$resurs_bank.each(["SE","DK","NO","FI"],function(j,h){if($resurs_bank("#method_list_"+h+"_spin").length===1){$resurs_bank("#method_list_"+h).html("")}})});getResursBankCountryArray("get_registered_callbacks","#callback_list_",function(c){if(typeof c.responseAdmin==="object"){}})}};