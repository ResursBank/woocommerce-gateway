/*! ResursCheckoutJS v0.06 - Generic Reurs Bank iFrame-driver for Resurs Checkout, for catching events in the Resurs Checkout iFrame */
;if(typeof ResursCheckout!=="function"&&typeof ResursCheckout==="undefined"){var currentResursEventNamePrefix="checkout";function ResursCheckout(){var j="";var g="";var l="0.06";var b={paymentMethod:"",customerData:{}};var e=false;var c=null;var f=null;var a=null;if(typeof arguments[0]!=="undefined"){j=arguments[0]}else{j="#resurs-checkout-container"}var i="";if(typeof RESURSCHECKOUT_IFRAME_URL!=="undefined"){i=RESURSCHECKOUT_IFRAME_URL}if(typeof OMNICHECKOUT_IFRAME_URL!=="undefined"){i=OMNICHECKOUT_IFRAME_URL}var d=function(m){if(typeof m==="function"){return true}};var h=function(n){var m;g=document.getElementsByTagName("iframe")[0];m=g.contentWindow||g.contentDocument;if(m&&typeof i==="string"&&i!==""){m.postMessage(JSON.stringify(n),i)}};var k={setBookingCallback:function(m){c=m},setPurchaseFailCallback:function(m){f=m},setCustomerChangedEventCallback:function(m){a=m},setDebug:function(m){if(m==1){m=true}e=m;console.log("ResursCheckoutJS verbosity level raised")},confirmOrder:function(m){if(typeof m!=="boolean"){m=false}if(e){console.log("ResursCheckoutJS - Confirm order with boolean: "+m)}h({eventType:currentResursEventNamePrefix+":order-status",orderReady:m})},postFrame:function(m){if(typeof m==="object"){if(e){console.log("ResursCheckoutJS - Sending message to iframe: "+JSON.stringify(m))}h(m)}},init:function(){window.addEventListener("message",function(p){var o=p.origin||p.originalEvent.origin;if(o!==i||typeof p.data!=="string"){return}var m=p.data;var n={};try{n=JSON.parse(m)}catch(q){return}if(n.hasOwnProperty("eventType")&&typeof n.eventType==="string"){switch(n.eventType){case currentResursEventNamePrefix+":loaded":h({eventType:currentResursEventNamePrefix+":set-purchase-button-interceptor",checkOrderBeforeBooking:true});break;default:if(n.eventType.indexOf(currentResursEventNamePrefix)>-1){if(n.eventType==currentResursEventNamePrefix+":payment-method-change"){if(e){console.log("ResursCheckoutJS - payment-method-change")}b.paymentMethod=n.method}else{if(n.eventType==currentResursEventNamePrefix+":user-info-change"){if(e){console.log("ResursCheckoutJS - user-info-change")}b.customerData={address:(typeof n.address!=="undefined"?n.address:{}),delivery:(typeof n.delivery!=="undefined"?n.delivery:{}),ssn:n.ssn,paymentMethod:(typeof b.paymentMethod!=="undefined"?b.paymentMethod:"")};if(typeof a==="function"){a(b)}}else{if(n.eventType==currentResursEventNamePrefix+":purchase-failed"){if(typeof f==="function"){f()}else{if(f==="string"){if(typeof window[f]==="function"){window[f]()}}}}else{if(n.eventType==currentResursEventNamePrefix+":puchase-button-clicked"){if(typeof c==="function"){if(e){console.log("ResursCheckoutJS - puchase-button-clicked event received, user defined callback is used.")}c(b,n)}else{if(typeof c==="string"){if(typeof window[c]==="function"){window[c](b,n)}}else{if(e){console.log("ResursCheckoutJS - puchase-button-clicked event received and not callbacks was found. Automatically confirming.")}h({eventType:currentResursEventNamePrefix+":order-status",orderReady:true})}}}}}}}}}},false)}};return k}};